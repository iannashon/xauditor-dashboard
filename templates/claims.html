<!-- templates/claims.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Claims â€” NHIS Auditor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="container">
    <h1>Claims Review</h1>

  <form method="get" action="{{ url_for('claims') }}" class="search-form">
  <input type="text" name="q" value="{{ q }}" placeholder="Search Diagnosis or Patient ID">
  <button type="submit">Search</button>

  <!-- Clear Search button: resets 'q' to empty -->
  {% if q %}
    <a href="{{ url_for('claims') }}" class="btn small clear-btn">Clear Search</a>
  {% endif %}

  <a href="{{ url_for('index') }}" class="btn small">Back to Dashboard</a>
</form>


    <p>Total matching claims: {{ total }}</p>

    <table class="claims-table">
      <thead>
        <tr>
          <th>Patient ID</th>
          <th>Diagnosis</th>
          <th>Amount</th>
          <th>Admitted</th>
          <th>Discharged</th>
          <th>LoS</th>
          <th>Fraud Score</th>
        </tr>
      </thead>
      <tbody>
        {% for r in claims %}
        <tr>
          <td>{{ r['patient_id'] }}</td>
          <td>{{ r['diagnosis'] }}</td>
          <td>{{ "{:,.2f}".format(r['amount_billed']) }}</td>
          <td>{{ r['date_admitted'] }}</td>
          <td>{{ r['date_discharged'] }}</td>
          <td>{{ r['length_of_stay'] }}</td>
          <td><strong>{{ r['fraud_score'] }}</strong></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="pagination">
      {% if page > 1 %}
        <a href="{{ url_for('claims', q=q, page=page-1) }}">Prev</a>
      {% endif %}
      <span>Page {{ page }} / {{ total_pages }}</span>
      {% if page < total_pages %}
        <a href="{{ url_for('claims', q=q, page=page+1) }}">Next</a>
      {% endif %}
    </div>
  </div>
</body>
</html>
